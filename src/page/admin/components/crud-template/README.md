# CrudTemplate Component

M·ªôt component React c√≥ th·ªÉ t√°i s·ª≠ d·ª•ng ƒë·ªÉ th·ª±c hi·ªán c√°c thao t√°c CRUD (Create, Read, Update, Delete) v·ªõi c√°c t√≠nh nƒÉng t√¨m ki·∫øm, l·ªçc v√† s·∫Øp x·∫øp.

## M·ª•c l·ª•c
- [T√≠nh nƒÉng](#t√≠nh-nƒÉng)
- [C√†i ƒë·∫∑t](#c√†i-ƒë·∫∑t)
- [C√°ch s·ª≠ d·ª•ng](#c√°ch-s·ª≠-d·ª•ng)
- [API Reference](#api-reference)
- [V√≠ d·ª•](#v√≠-d·ª•)
- [Customization](#customization)

## T√≠nh nƒÉng

- ‚úÖ **CRUD Operations**: Create, Read, Update, Delete
- üîç **T√¨m ki·∫øm**: T√¨m ki·∫øm theo m·ªôt tr∆∞·ªùng c·ª• th·ªÉ
- üéØ **L·ªçc d·ªØ li·ªáu**: L·ªçc theo nhi·ªÅu tr∆∞·ªùng v·ªõi nhi·ªÅu lo·∫°i input
- üìä **S·∫Øp x·∫øp**: S·∫Øp x·∫øp d·ªØ li·ªáu theo nhi·ªÅu ti√™u ch√≠
- üìù **Form Validation**: Validation t·ª± ƒë·ªông v·ªõi react-hook-form
- üé® **UI Components**: S·ª≠ d·ª•ng shadcn/ui components
- üîî **Toast Notifications**: Th√¥ng b√°o th√†nh c√¥ng/l·ªói v·ªõi Sonner
- üåê **Generic Types**: H·ªó tr·ª£ TypeScript v·ªõi generic types

## C√†i ƒë·∫∑t

Component n√†y ƒë√£ ƒë∆∞·ª£c t√≠ch h·ª£p s·∫µn trong project. Ch·ªâ c·∫ßn import v√† s·ª≠ d·ª•ng:

```tsx
import CrudTemplate from "@/page/admin/components/crud-template";
```

## C√°ch s·ª≠ d·ª•ng

### B∆∞·ªõc 1: ƒê·ªãnh nghƒ©a Type cho d·ªØ li·ªáu

```tsx
interface CarEv {
  id: string;
  modelId: string;
  depotId: string;
  color: string;
  plateNumber: string;
  // ... c√°c tr∆∞·ªùng kh√°c
}
```

### B∆∞·ªõc 2: T·∫°o API interface

```tsx
import { CrudAPI } from "@/@types/api.interface";

const carEvApi: CrudAPI<CarEv> = {
  getAll: async () => {
    return await carEvAPI.getAll();
  },
  getById: async (id: string) => {
    return await carEvAPI.getById(id);
  },
  create: async (data) => {
    return await carEvAPI.create(data);
  },
  update: async (id: string, data) => {
    return await carEvAPI.update(id, data);
  },
  delete: async (id: string) => {
    return await carEvAPI.delete(id);
  },
};
```

### B∆∞·ªõc 3: ƒê·ªãnh nghƒ©a form items

```tsx
import { FormItem } from "@/@types/api.interface";

const formItems: FormItem<CarEv>[] = [
  {
    name: "plateNumber",
    label: "Bi·ªÉn s·ªë xe",
    type: "text",
    required: true,
    placeholder: "VD: 30A-12345",
  },
  {
    name: "modelId",
    label: "Model",
    required: true,
    render: (register) => (
      <Select {...register("modelId")}>
        {/* your select options */}
      </Select>
    ),
  },
  // ... c√°c tr∆∞·ªùng kh√°c
];
```

### B∆∞·ªõc 4: ƒê·ªãnh nghƒ©a columns cho b·∫£ng

```tsx
import { Column } from "@/page/admin/components/crud-template";

const columns: Column<CarEv>[] = [
  {
    key: "plateNumber",
    title: "Bi·ªÉn s·ªë",
    dataIndex: "plateNumber",
  },
  {
    key: "color",
    title: "M√†u s·∫Øc",
    dataIndex: "color",
    render: (value) => <Badge>{value}</Badge>,
  },
  // ... c√°c c·ªôt kh√°c
];
```

### B∆∞·ªõc 5: S·ª≠ d·ª•ng component

```tsx
import CrudTemplate from "@/page/admin/components/crud-template";

const MyPage = () => {
  return (
    <CrudTemplate
      columns={columns}
      api={carEvApi}
      formItems={formItems}
      addButtonText="Th√™m xe m·ªõi"
      editButtonText="S·ª≠a"
      deleteButtonText="X√≥a"
      searchField="plateNumber"
    />
  );
};
```

## API Reference

### Props

| Prop | Type | Required | Default | M√¥ t·∫£ |
|------|------|----------|---------|-------|
| `columns` | `Column<T>[]` | ‚úÖ | - | C·∫•u h√¨nh c√°c c·ªôt hi·ªÉn th·ªã trong b·∫£ng |
| `api` | `CrudAPI<T, TRequest>` | ‚úÖ | - | API interface ƒë·ªÉ th·ª±c hi·ªán CRUD operations |
| `formItems` | `FormItem<T>[]` | ‚úÖ | - | C·∫•u h√¨nh c√°c tr∆∞·ªùng trong form |
| `addButtonText` | `string` | ‚ùå | "Add Item" | Text hi·ªÉn th·ªã tr√™n n√∫t th√™m m·ªõi |
| `editButtonText` | `string` | ‚ùå | "Edit" | Text hi·ªÉn th·ªã tr√™n n√∫t s·ª≠a |
| `deleteButtonText` | `string` | ‚ùå | "Delete" | Text hi·ªÉn th·ªã tr√™n n√∫t x√≥a |
| `deleteConfirmTitle` | `string` | ‚ùå | "Delete Item" | Ti√™u ƒë·ªÅ dialog x√°c nh·∫≠n x√≥a |
| `deleteConfirmDescription` | `string` | ‚ùå | "Are you sure..." | M√¥ t·∫£ dialog x√°c nh·∫≠n x√≥a |
| `successMessages` | `object` | ‚ùå | `{create: "Item created...", update: "Item updated...", delete: "Item deleted..."}` | Th√¥ng b√°o th√†nh c√¥ng |
| `searchField` | `string` | ‚ùå | "name" | Tr∆∞·ªùng ƒë·ªÉ t√¨m ki·∫øm |
| `sortOptions` | `SortOption<T>[]` | ‚ùå | `[]` | C√°c t√πy ch·ªçn s·∫Øp x·∫øp |
| `filterOptions` | `FilterOption<T>[]` | ‚ùå | `[]` | C√°c t√πy ch·ªçn l·ªçc |

### Types

#### `Column<T>`
```tsx
interface Column<T> {
  key: string;              // Unique key cho c·ªôt
  title: string;            // Ti√™u ƒë·ªÅ hi·ªÉn th·ªã
  dataIndex: string;        // Tr∆∞·ªùng d·ªØ li·ªáu trong object
  render?: (value: unknown, record: T) => React.ReactNode; // Custom render
}
```

#### `CrudAPI<T, TRequest>`
```tsx
interface CrudAPI<T, TRequest = Partial<T>> {
  getAll: (pageNumber?: number, pageSize?: number) => Promise<AxiosResponse<ListBaseResponse<T>>>;
  getById: (id: string) => Promise<T>;
  create: (data: TRequest) => Promise<T>;
  update: (id: string, data: TRequest) => Promise<T>;
  delete: (id: string) => Promise<void>;
}
```

#### `FormItem<T>`
```tsx
interface FormItem<T extends FieldValues> {
  name: string;             // Field name (required)
  label: string;            // Label hi·ªÉn th·ªã
  type?: "text" | "number" | "email" | "password" | "date";
  required?: boolean;       // C√≥ b·∫Øt bu·ªôc hay kh√¥ng
  placeholder?: string;     // Placeholder text
  render?: (register: UseFormRegister<T>) => React.ReactNode; // Custom render
}
```

#### `SortOption<T>`
```tsx
interface SortOption<T> {
  value: string;            // Unique value
  label: string;            // Label hi·ªÉn th·ªã
  sortFn: (a: T, b: T) => number; // Sort function
}
```

#### `FilterOption<T>`
```tsx
interface FilterOption<T> {
  field: keyof T;           // Field ƒë·ªÉ l·ªçc
  label: string;            // Label hi·ªÉn th·ªã
  type: "select" | "text";  // Lo·∫°i input
  options?: Array<{ value: string; label: string }>; // Options cho select
}
```

## V√≠ d·ª•

### V√≠ d·ª• c∆° b·∫£n

```tsx
import CrudTemplate from "@/page/admin/components/crud-template";
import { carEvApi } from "@/apis/car-ev.api";
import type { CarEv } from "@/@types/car/carEv";

const CarEvManagement = () => {
  const columns: Column<CarEv>[] = [
    { key: "id", title: "ID", dataIndex: "id" },
    { key: "plateNumber", title: "Bi·ªÉn s·ªë", dataIndex: "plateNumber" },
    { key: "color", title: "M√†u s·∫Øc", dataIndex: "color" },
  ];

  const formItems: FormItem<CarEv>[] = [
    {
      name: "plateNumber",
      label: "Bi·ªÉn s·ªë xe",
      type: "text",
      required: true,
    },
    {
      name: "color",
      label: "M√†u s·∫Øc",
      type: "text",
      required: true,
    },
  ];

  return (
    <CrudTemplate
      columns={columns}
      api={carEvApi}
      formItems={formItems}
    />
  );
};
```

### V√≠ d·ª• v·ªõi Custom Render

```tsx
const columns: Column<CarEv>[] = [
  {
    key: "status",
    title: "Tr·∫°ng th√°i",
    dataIndex: "status",
    render: (value) => (
      <Badge variant={value === "active" ? "default" : "secondary"}>
        {value}
      </Badge>
    ),
  },
];
```

### V√≠ d·ª• v·ªõi Custom Form Field

```tsx
const formItems: FormItem<CarEv>[] = [
  {
    name: "modelId",
    label: "Model",
    required: true,
    render: (register) => (
      <Select {...register("modelId")}>
        <SelectContent>
          <SelectItem value="1">Model A</SelectItem>
          <SelectItem value="2">Model B</SelectItem>
        </SelectContent>
      </Select>
    ),
  },
];
```

### V√≠ d·ª• v·ªõi Sorting

```tsx
const sortOptions: SortOption<CarEv>[] = [
  {
    value: "plateNumber-asc",
    label: "Bi·ªÉn s·ªë A-Z",
    sortFn: (a, b) => (a.plateNumber || "").localeCompare(b.plateNumber || ""),
  },
  {
    value: "plateNumber-desc",
    label: "Bi·ªÉn s·ªë Z-A",
    sortFn: (a, b) => (b.plateNumber || "").localeCompare(a.plateNumber || ""),
  },
];

<CrudTemplate
  columns={columns}
  api={carEvApi}
  formItems={formItems}
  sortOptions={sortOptions}
/>
```

### V√≠ d·ª• v·ªõi Filtering

```tsx
const filterOptions: FilterOption<CarEv>[] = [
  {
    field: "color",
    label: "M√†u s·∫Øc",
    type: "select",
    options: [
      { value: "ƒê·ªè", label: "ƒê·ªè" },
      { value: "Xanh", label: "Xanh" },
      { value: "Tr·∫Øng", label: "Tr·∫Øng" },
    ],
  },
  {
    field: "depotId",
    label: "Depot",
    type: "text",
  },
];

<CrudTemplate
  columns={columns}
  api={carEvApi}
  formItems={formItems}
  filterOptions={filterOptions}
/>
```

### V√≠ d·ª• v·ªõi t·∫•t c·∫£ t√≠nh nƒÉng

```tsx
const MyPage = () => {
  return (
    <CrudTemplate
      columns={columns}
      api={carEvApi}
      formItems={formItems}
      addButtonText="Th√™m xe m·ªõi"
      editButtonText="Ch·ªânh s·ª≠a"
      deleteButtonText="X√≥a b·ªè"
      searchField="plateNumber"
      sortOptions={sortOptions}
      filterOptions={filterOptions}
      successMessages={{
        create: "ƒê√£ th√™m xe th√†nh c√¥ng!",
        update: "ƒê√£ c·∫≠p nh·∫≠t xe th√†nh c√¥ng!",
        delete: "ƒê√£ x√≥a xe th√†nh c√¥ng!",
      }}
      deleteConfirmTitle="X√°c nh·∫≠n x√≥a"
      deleteConfirmDescription="B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a xe n√†y? H√†nh ƒë·ªông n√†y kh√¥ng th·ªÉ ho√†n t√°c."
    />
  );
};
```

## Customization

### Custom Form Validation

```tsx
import { useForm } from "react-hook-form";

const formItems: FormItem<CarEv>[] = [
  {
    name: "email",
    label: "Email",
    type: "email",
    required: true,
    // Validation s·∫Ω t·ª± ƒë·ªông ƒë∆∞·ª£c th√™m b·ªüi react-hook-form
  },
];
```

### Custom API v·ªõi Error Handling

```tsx
const carEvApi: CrudAPI<CarEv> = {
  getAll: async () => {
    try {
      const response = await axios.get("/api/cars");
      return response;
    } catch (error) {
      console.error("Error fetching cars:", error);
      throw error;
    }
  },
  // ... other methods
};
```

### Th√™m Custom Actions

B·∫°n c√≥ th·ªÉ m·ªü r·ªông component ƒë·ªÉ th√™m custom actions b·∫±ng c√°ch:

1. Th√™m c·ªôt m·ªõi v·ªõi custom render cho action buttons
2. S·ª≠ d·ª•ng `onClick` ƒë·ªÉ x·ª≠ l√Ω logic t√πy ch·ªânh

```tsx
const columns: Column<CarEv>[] = [
  // ... existing columns
  {
    key: "customAction",
    title: "Actions",
    dataIndex: "id",
    render: (_, record) => (
      <Button onClick={() => handleCustomAction(record)}>
        Custom Action
      </Button>
    ),
  },
];
```

## L∆∞u √Ω

1. **ID Field**: Component y√™u c·∫ßu record ph·∫£i c√≥ field `id` ƒë·ªÉ th·ª±c hi·ªán update/delete
2. **Response Structure**: API response ph·∫£i c√≥ c·∫•u tr√∫c:
   ```tsx
   {
     data: {
       data: {
         items: T[]
       }
     }
   }
   ```
3. **Form Validation**: S·ª≠ d·ª•ng react-hook-form ƒë·ªÉ validation, t·∫•t c·∫£ c√°c field c√≥ `required: true` s·∫Ω ƒë∆∞·ª£c validate t·ª± ƒë·ªông
4. **TypeScript**: Component s·ª≠ d·ª•ng generic types, ƒë·∫£m b·∫£o type safety khi s·ª≠ d·ª•ng

## Troubleshooting

### L·ªói: "Failed to fetch data"
- Ki·ªÉm tra API endpoint c√≥ ho·∫°t ƒë·ªông kh√¥ng
- Ki·ªÉm tra response structure c√≥ ƒë√∫ng format kh√¥ng

### L·ªói: Validation kh√¥ng ho·∫°t ƒë·ªông
- ƒê·∫£m b·∫£o `required` field ƒë∆∞·ª£c set ƒë√∫ng trong formItems
- Ki·ªÉm tra type c·ªßa form field

### L·ªói: Delete kh√¥ng ho·∫°t ƒë·ªông
- Ki·ªÉm tra record c√≥ field `id` kh√¥ng
- Ki·ªÉm tra API delete method c√≥ return ƒë√∫ng kh√¥ng

## Li√™n quan

- [shadcn/ui Components](https://ui.shadcn.com/)
- [React Hook Form](https://react-hook-form.com/)
- [Sonner Toast](https://sonner.emilkowal.ski/)

